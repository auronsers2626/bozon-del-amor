<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>BuzÃ³n del Coso</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1 id="titulo">BuzÃ³n del Coso</h1>

  <div id="contenedor">
    <img id="buzon" src="buzon.png" alt="BuzÃ³n cerrado">
    
    <div id="carta" class="oculto">
      <div id="contenido-carta">
        <p>
          ğŸ’Œ NUEVO MENSAJE DE: EL BUZÃ“N DEL COSO S.A.<br><br>
          Asunto: Â¡Tu corazÃ³n tiene una notificaciÃ³n pendienteğŸ’™<br><br>
          Â¡Hola, Molsa preciosa!  
Gracias por seguir suscrita al sistema de correos del BUZÃ“N DEL COSO S.A., donde cada latido tiene tu nombre.
<br><br>
          Tenemos una oferta exclusiva solo para ti:  
1 abrazo para toda la vida + 2000 besos de 8 aÃ±os cada uno + 1te amo sin fecha de vencimiento.  
Todo esto, enviado directamente desde el corazÃ³n de tu coso
Â¿Por quÃ© recibes este mensaje?  
Porque alguien pensÃ³ en ti justo ahora.  
Porque tu sonrisa activa todos los algoritmos de mi corazÃ³n. 
Porque el coso no puede dejar de amarte, ni siquiera cuando intenta hacer otra cosa.<br><br>
          Â¿Quieres cancelar esta suscripciÃ³n?  
Imposible. Este amor no tiene botÃ³n de â€œunsubscribeâ€.  
Solo puedes archivarlo en tu corazÃ³n, marcarlo como favorito o responderlo con un te amo.
        </p>
        <button id="borrar">Borrar</button>
      </div>
    </div>

    <p id="mensaje"></p>
    <div id="contador"></div>
  </div>

  <script>
    const buzÃ³n = document.getElementById("buzon");
    const carta = document.getElementById("carta");
    const borrar = document.getElementById("borrar");
    const mensaje = document.getElementById("mensaje");
    const contador = document.getElementById("contador");

    const TIEMPO_ESPERA = 24 * 60 * 60 * 1000;

    function iniciarContador() {
      const ahora = Date.now();
      localStorage.setItem("siguienteCarta", ahora + TIEMPO_ESPERA);
      actualizarEstado();
    }

    function actualizarEstado() {
      const siguiente = localStorage.getItem("siguienteCarta");
      const ahora = Date.now();

      if (!siguiente || ahora >= siguiente) {
        mensaje.textContent = "Â¡Tienes una nueva carta en el buzÃ³n!";
        contador.textContent = "";
        buzÃ³n.src = "buzon.png";
        buzÃ³n.style.pointerEvents = "auto";
        buzÃ³n.style.opacity = "1";
        carta.classList.add("oculto");
      } else {
        mensaje.textContent = "Mensaje entregado, Gracias, Tu presencia mejora todos nuestros sistemas. Vuelve en 24 horas."
        buzÃ³n.src = "buzon.png";
        buzÃ³n.style.pointerEvents = "none";
        buzÃ³n.style.opacity = "0.6";
        carta.classList.add("oculto");
        actualizarContador(siguiente - ahora);
      }
    }

    function actualizarContador(tiempoRestante) {
      function formato(t) {
        const h = Math.floor(t / 3600);
        const m = Math.floor((t % 3600) / 60);
        const s = Math.floor(t % 60);
        return `${h}h ${m}m ${s}s`;
      }

      const intervalo = setInterval(() => {
        const siguiente = localStorage.getItem("siguienteCarta");
        const ahora = Date.now();
        const restante = Math.floor((siguiente - ahora) / 1000);

        if (restante <= 0) {
          clearInterval(intervalo);
          actualizarEstado();
        } else {
          contador.textContent = `â³ ${formato(restante)} restantes`;
        }
      }, 1000);
    }

    buzÃ³n.addEventListener("click", () => {
      carta.classList.remove("oculto");
      buzÃ³n.style.display = "none";
    });

    borrar.addEventListener("click", () => {
      carta.classList.add("oculto");
      buzÃ³n.style.display = "block";
      buzÃ³n.src = "buzon.png";
      iniciarContador();
    });

    actualizarEstado();
  </script>
</body>
</html>
