<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Buzón del Coso</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1 id="titulo">Buzón del Coso</h1>

  <div id="contenedor">
    <img id="buzon" src="buzon.png" alt="Buzón cerrado">
    
    <div id="carta" class="oculto">
      <div id="contenido-carta">
        <p>
          Mi amor:<br><br>
          Sabias que?.<br><br>
          Las estrellas que vemos hoy pueden haber muerto hace millones de años?, pero su luz sigue viajando, a y tocando nuestos ojos haciendose visibles<br><br>
          Asi es mi amor por ti, Eterno, Brillante, e Imposible de apagar. Ademas debes saber que la luna cambia de forma pero jamas desaparece,
          eso me recuerda a que en los dias en los que apenas hablamos, tu sigues siendo mi luz, en los momentos mas oscuros, no importa cuan lejos estes,
          ni cuan escuro parezca el cielo, yo siempre te busco entre constelaciones porque tu siempre seras mi norte, mi noche favorita y mi universo<br><br>
          Te amo mucho mi cosota hermosa
        </p>
        <button id="borrar">Borrar</button>
      </div>
    </div>

    <p id="mensaje"></p>
    <div id="contador"></div>
  </div>

  <script>
    const buzón = document.getElementById("buzon");
    const carta = document.getElementById("carta");
    const borrar = document.getElementById("borrar");
    const mensaje = document.getElementById("mensaje");
    const contador = document.getElementById("contador");

    const TIEMPO_ESPERA = 24 * 60 * 60 * 1000;

    function iniciarContador() {
      const ahora = Date.now();
      localStorage.setItem("siguienteCarta", ahora + TIEMPO_ESPERA);
      actualizarEstado();
    }

    function actualizarEstado() {
      const siguiente = localStorage.getItem("siguienteCarta");
      const ahora = Date.now();

      if (!siguiente || ahora >= siguiente) {
        mensaje.textContent = "¡Tienes una nueva carta en el buzón!";
        contador.textContent = "";
        buzón.src = "buzon.png";
        buzón.style.pointerEvents = "auto";
        buzón.style.opacity = "1";
        carta.classList.add("oculto");
      } else {
        mensaje.textContent = "Mensaje entregado, el cartero dice que te vio sonreir. Vuelve en 24 horas.";
        buzón.src = "buzon.png";
        buzón.style.pointerEvents = "none";
        buzón.style.opacity = "0.6";
        carta.classList.add("oculto");
        actualizarContador(siguiente - ahora);
      }
    }

    function actualizarContador(tiempoRestante) {
      function formato(t) {
        const h = Math.floor(t / 3600);
        const m = Math.floor((t % 3600) / 60);
        const s = Math.floor(t % 60);
        return `${h}h ${m}m ${s}s`;
      }

      const intervalo = setInterval(() => {
        const siguiente = localStorage.getItem("siguienteCarta");
        const ahora = Date.now();
        const restante = Math.floor((siguiente - ahora) / 1000);

        if (restante <= 0) {
          clearInterval(intervalo);
          actualizarEstado();
        } else {
          contador.textContent = `⏳ ${formato(restante)} restantes`;
        }
      }, 1000);
    }

    buzón.addEventListener("click", () => {
      carta.classList.remove("oculto");
      buzón.style.display = "none";
    });

    borrar.addEventListener("click", () => {
      carta.classList.add("oculto");
      buzón.style.display = "block";
      buzón.src = "buzon.png";
      iniciarContador();
    });

    actualizarEstado();
  </script>
</body>
</html>



